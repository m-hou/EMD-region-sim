from scipy.optimize import linprog
import numpy as np
import random

def construct_V(H, eta, G, num_histogram_to_sample):
    V = [H]
    for _ in range(num_histogram_to_sample):
        sample_point = sample_histogram_within_EMD(H, eta, G)
        if not point_within_affine_V(V, sample_point):
            V.append(sample_point)
            V = remove_redundent_points(V)
    return V

def construct_V_until_stable(H, eta, G, iters_to_stable):
    V = [H]
    stable_iters = 0
    while stable_iters < iters_to_stable:
        sample_point = sample_histogram_within_EMD(H, eta, G)
        if not point_within_affine_V(V, sample_point):
            V.append(sample_point)
            V = remove_redundent_points(V)
            stable_iters = 0
        stable_iters += 1
    return V

def sample_histogram_within_EMD(H, eta, G):

    LEFT, RIGHT = 1, -1

    def reverse_move(move_index, move_direction):
        return (move_index + move_direction , -move_direction)

    def generate_possible_moves(len_H):
        left_moves = set((i, LEFT) for i in range(len_H - 1))
        right_moves = set(reverse_move(*move) for move in left_moves)
        return left_moves | right_moves

    available_move_index_direction = generate_possible_moves(len(H))

    new_H = list(H)
    budget = round(eta / G)

    keep_going = True
    while keep_going:
        move_index, move_direction = random.choice(list(available_move_index_direction))
        granules_to_move = min(random.randint(1, budget), round(new_H[move_index] / G))
        apply_move_to_histogram(new_H, move_index, move_direction, granules_to_move * G)

        available_move_index_direction.remove((move_index, move_direction))
        available_move_index_direction.remove(reverse_move(move_index, move_direction))
        budget -= granules_to_move
        keep_going = available_move_index_direction and budget > 0 and random.choice([True, False])
    
    return new_H

def apply_move_to_histogram(histogram, move_index, move_direction, mass_to_move):
    histogram[move_index] -= mass_to_move
    histogram[move_index + move_direction] += mass_to_move

def point_within_affine_V(V, P):
    c = np.repeat(1, len(V))
    A_eq = np.transpose(np.array([np.array(v) for v in V]))
    b_eq = np.array(P)
    A_ub = np.transpose(np.array([np.array([1]) for _ in V]))
    b_ub = np.array([1])

    solution = linprog(c, A_ub, b_ub, A_eq, b_eq)
    return solution.success

def remove_redundent_points(V):
    new_V = []
    for i in range(len(V)):
        test_point = V[i]
        V_prime = V[:i] + V[i+1:]
        if not point_within_affine_V(V_prime, test_point):
            new_V.append(test_point)
    return new_V


# V1 = construct_V([0.25] * 4, 0.5, 0.25, 1000)
# print("4 buckets")
# print(len(V1))
# print(V1)

# V1 = construct_V_until_stable([0.25] * 4, 0.5, 0.25, 1000)
# print("4 buckets")
# print(len(V1))
# print(V1)

# V2 = construct_V([0.2] * 5, 0.4, 0.2, 1000)
# print("5 buckets")
# print(len(V2))
# print(V2)

# V3 = construct_V([0.125] * 8, 0.5, 0.125, 10000)
# print("8 buckets")
# print(len(V3))
# print(V3)

# V3 = construct_V_until_stable([0.125] * 8, 0.5, 0.125, 25000)
# print("8 buckets")
# print(len(V3))
# print(V3)

# V4 = construct_V([0.1] * 10, 0.5, 0.1, 10000)
# print("10 buckets")
# print(len(V4))
# print(V4)

from collections import defaultdict

sim_V = [[0.0, 0.375, 0.125, 0.0, 0.25, 0.0, 0.125, 0.125], [0.125, 0.125, 0.125, 0.125, 0.0, 0.5, 0.0, 0.0], [0.125, 0.0, 0.25, 0.125, 0.125, 0.0, 0.0, 0.375], [0.125, 0.25, 0.0, 0.0, 0.0, 0.375, 0.125, 0.125], [0.0, 0.25, 0.375, 0.0, 0.0, 0.125, 0.125, 0.125], [0.0, 0.25, 0.125, 0.0, 0.25, 0.0, 0.375, 0.0], [0.125, 0.25, 0.0, 0.0, 0.125, 0.375, 0.0, 0.125], [0.125, 0.0, 0.0, 0.375, 0.125, 0.125, 0.0, 0.25], [0.0, 0.125, 0.25, 0.125, 0.0, 0.375, 0.0, 0.125], [0.125, 0.125, 0.125, 0.125, 0.25, 0.25, 0.0, 0.0], [0.25, 0.0, 0.125, 0.125, 0.125, 0.375, 0.0, 0.0], [0.0, 0.25, 0.0, 0.25, 0.0, 0.25, 0.0, 0.25], [0.125, 0.25, 0.0, 0.25, 0.125, 0.0, 0.0, 0.25], [0.0, 0.375, 0.125, 0.0, 0.0, 0.25, 0.125, 0.125], [0.25, 0.0, 0.25, 0.0, 0.0, 0.25, 0.0, 0.25], [0.0, 0.375, 0.0, 0.0, 0.25, 0.0, 0.25, 0.125], [0.125, 0.0, 0.375, 0.0, 0.125, 0.0, 0.375, 0.0], [0.125, 0.125, 0.375, 0.0, 0.0, 0.125, 0.0, 0.25], [0.125, 0.0, 0.25, 0.0, 0.25, 0.0, 0.375, 0.0], [0.125, 0.25, 0.0, 0.125, 0.375, 0.0, 0.0, 0.125], [0.0, 0.25, 0.125, 0.25, 0.125, 0.0, 0.0, 0.25], [0.25, 0.0, 0.0, 0.375, 0.0, 0.25, 0.0, 0.125], [0.0, 0.375, 0.0, 0.125, 0.0, 0.125, 0.25, 0.125], [0.125, 0.125, 0.125, 0.0, 0.0, 0.375, 0.25, 0.0], [0.125, 0.0, 0.5, 0.0, 0.0, 0.125, 0.125, 0.125], [0.125, 0.125, 0.0, 0.125, 0.125, 0.25, 0.25, 0.0], [0.0, 0.25, 0.0, 0.25, 0.0, 0.125, 0.25, 0.125], [0.0, 0.25, 0.25, 0.0, 0.25, 0.0, 0.25, 0.0], [0.0, 0.5, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125], [0.375, 0.0, 0.0, 0.125, 0.0, 0.25, 0.125, 0.125], [0.125, 0.25, 0.0, 0.25, 0.125, 0.125, 0.0, 0.125], [0.25, 0.0, 0.25, 0.0, 0.0, 0.375, 0.0, 0.125], [0.0, 0.0, 0.375, 0.125, 0.125, 0.0, 0.25, 0.125], [0.25, 0.0, 0.0, 0.25, 0.25, 0.0, 0.0, 0.25], [0.125, 0.25, 0.125, 0.0, 0.25, 0.0, 0.0, 0.25], [0.125, 0.125, 0.125, 0.25, 0.25, 0.0, 0.0, 0.125], [0.125, 0.125, 0.0, 0.375, 0.0, 0.0, 0.375, 0.0], [0.0, 0.25, 0.25, 0.0, 0.25, 0.0, 0.0, 0.25], [0.0, 0.375, 0.125, 0.0, 0.125, 0.0, 0.25, 0.125], [0.25, 0.0, 0.0, 0.125, 0.125, 0.25, 0.125, 0.125], [0.125, 0.125, 0.125, 0.0, 0.0, 0.375, 0.0, 0.25], [0.125, 0.25, 0.0, 0.0, 0.375, 0.125, 0.0, 0.125], [0.125, 0.125, 0.125, 0.25, 0.0, 0.0, 0.0, 0.375], [0.25, 0.0, 0.125, 0.125, 0.375, 0.0, 0.0, 0.125], [0.0, 0.125, 0.375, 0.0, 0.125, 0.25, 0.0, 0.125], [0.125, 0.375, 0.0, 0.0, 0.0, 0.25, 0.125, 0.125], [0.125, 0.0, 0.375, 0.0, 0.0, 0.375, 0.0, 0.125], [0.125, 0.0, 0.125, 0.125, 0.25, 0.125, 0.25, 0.0], [0.0, 0.25, 0.125, 0.125, 0.0, 0.125, 0.125, 0.25], [0.125, 0.125, 0.375, 0.0, 0.0, 0.0, 0.25, 0.125], [0.125, 0.0, 0.375, 0.0, 0.0, 0.25, 0.25, 0.0], [0.125, 0.0, 0.125, 0.0, 0.375, 0.125, 0.125, 0.125], [0.125, 0.375, 0.0, 0.0, 0.125, 0.125, 0.0, 0.25], [0.25, 0.0, 0.125, 0.0, 0.25, 0.0, 0.125, 0.25], [0.125, 0.125, 0.25, 0.0, 0.0, 0.0, 0.375, 0.125], [0.125, 0.0, 0.125, 0.25, 0.25, 0.0, 0.25, 0.0], [0.125, 0.375, 0.0, 0.0, 0.125, 0.0, 0.25, 0.125], [0.0, 0.125, 0.25, 0.0, 0.25, 0.0, 0.25, 0.125], [0.125, 0.25, 0.0, 0.25, 0.0, 0.0, 0.375, 0.0], [0.0, 0.25, 0.25, 0.125, 0.0, 0.0, 0.25, 0.125], [0.125, 0.0, 0.125, 0.375, 0.0, 0.25, 0.0, 0.125], [0.375, 0.0, 0.0, 0.125, 0.125, 0.125, 0.0, 0.25], [0.0, 0.375, 0.0, 0.125, 0.0, 0.25, 0.25, 0.0], [0.125, 0.25, 0.125, 0.0, 0.25, 0.0, 0.25, 0.0], [0.0, 0.25, 0.0, 0.125, 0.25, 0.125, 0.0, 0.25], [0.25, 0.0, 0.0, 0.375, 0.125, 0.0, 0.125, 0.125], [0.0, 0.25, 0.125, 0.0, 0.125, 0.125, 0.25, 0.125], [0.125, 0.25, 0.25, 0.0, 0.0, 0.125, 0.125, 0.125], [0.125, 0.125, 0.0, 0.125, 0.375, 0.0, 0.0, 0.25], [0.25, 0.0, 0.25, 0.125, 0.0, 0.125, 0.25, 0.0], [0.25, 0.125, 0.0, 0.25, 0.0, 0.125, 0.25, 0.0], [0.0, 0.25, 0.0, 0.125, 0.125, 0.25, 0.125, 0.125], [0.125, 0.0, 0.375, 0.0, 0.0, 0.25, 0.0, 0.25], [0.0, 0.25, 0.25, 0.0, 0.0, 0.25, 0.0, 0.25], [0.125, 0.125, 0.0, 0.125, 0.0, 0.375, 0.125, 0.125], [0.0, 0.25, 0.125, 0.0, 0.375, 0.0, 0.25, 0.0], [0.0, 0.25, 0.125, 0.375, 0.0, 0.0, 0.125, 0.125], [0.0, 0.125, 0.25, 0.25, 0.0, 0.0, 0.25, 0.125], [0.25, 0.0, 0.0, 0.25, 0.125, 0.25, 0.125, 0.0], [0.125, 0.25, 0.0, 0.0, 0.25, 0.0, 0.125, 0.25], [0.125, 0.125, 0.0, 0.0, 0.5, 0.0, 0.125, 0.125], [0.125, 0.125, 0.0, 0.125, 0.375, 0.0, 0.25, 0.0], [0.0, 0.25, 0.125, 0.0, 0.25, 0.25, 0.125, 0.0], [0.0, 0.25, 0.125, 0.125, 0.25, 0.125, 0.125, 0.0], [0.25, 0.0, 0.0, 0.125, 0.25, 0.125, 0.25, 0.0], [0.0, 0.25, 0.25, 0.0, 0.0, 0.25, 0.25, 0.0], [0.25, 0.125, 0.125, 0.0, 0.25, 0.0, 0.125, 0.125], [0.0, 0.125, 0.125, 0.25, 0.25, 0.0, 0.125, 0.125], [0.0, 0.375, 0.0, 0.0, 0.375, 0.0, 0.125, 0.125], [0.125, 0.125, 0.0, 0.5, 0.0, 0.0, 0.125, 0.125], [0.0, 0.375, 0.0, 0.0, 0.25, 0.125, 0.0, 0.25], [0.125, 0.0, 0.125, 0.375, 0.0, 0.125, 0.0, 0.25], [0.25, 0.125, 0.0, 0.125, 0.0, 0.25, 0.25, 0.0], [0.25, 0.0, 0.25, 0.125, 0.0, 0.125, 0.0, 0.25], [0.125, 0.25, 0.125, 0.0, 0.125, 0.0, 0.375, 0.0], [0.125, 0.125, 0.25, 0.25, 0.0, 0.0, 0.125, 0.125], [0.0, 0.375, 0.0, 0.125, 0.125, 0.0, 0.375, 0.0], [0.125, 0.125, 0.0, 0.25, 0.0, 0.125, 0.375, 0.0], [0.0, 0.25, 0.125, 0.0, 0.0, 0.375, 0.125, 0.125], [0.25, 0.0, 0.25, 0.0, 0.125, 0.25, 0.125, 0.0], [0.125, 0.25, 0.125, 0.0, 0.0, 0.25, 0.0, 0.25], [0.25, 0.0, 0.125, 0.125, 0.0, 0.0, 0.375, 0.125], [0.0, 0.25, 0.0, 0.125, 0.375, 0.0, 0.125, 0.125], [0.125, 0.0, 0.375, 0.0, 0.25, 0.125, 0.0, 0.125], [0.125, 0.125, 0.25, 0.125, 0.0, 0.0, 0.375, 0.0], [0.125, 0.0, 0.125, 0.25, 0.0, 0.25, 0.25, 0.0], [0.25, 0.0, 0.25, 0.125, 0.0, 0.25, 0.0, 0.125], [0.125, 0.0, 0.25, 0.0, 0.25, 0.0, 0.125, 0.25], [0.125, 0.0, 0.25, 0.0, 0.125, 0.25, 0.0, 0.25], [0.0, 0.125, 0.375, 0.0, 0.125, 0.125, 0.0, 0.25], [0.125, 0.0, 0.25, 0.125, 0.375, 0.0, 0.0, 0.125], [0.375, 0.0, 0.125, 0.0, 0.125, 0.125, 0.125, 0.125], [0.125, 0.125, 0.0, 0.0, 0.25, 0.25, 0.125, 0.125], [0.125, 0.125, 0.25, 0.125, 0.125, 0.0, 0.25, 0.0], [0.375, 0.0, 0.0, 0.125, 0.125, 0.0, 0.25, 0.125], [0.125, 0.0, 0.375, 0.125, 0.125, 0.0, 0.125, 0.125], [0.25, 0.0, 0.125, 0.0, 0.0, 0.375, 0.125, 0.125], [0.125, 0.0, 0.0, 0.375, 0.125, 0.0, 0.25, 0.125], [0.125, 0.25, 0.0, 0.0, 0.25, 0.25, 0.125, 0.0], [0.125, 0.125, 0.125, 0.0, 0.125, 0.125, 0.375, 0.0], [0.125, 0.0, 0.0, 0.25, 0.25, 0.125, 0.125, 0.125], [0.125, 0.25, 0.0, 0.0, 0.25, 0.0, 0.375, 0.0], [0.125, 0.0, 0.25, 0.125, 0.125, 0.375, 0.0, 0.0], [0.125, 0.25, 0.0, 0.0, 0.125, 0.25, 0.0, 0.25], [0.25, 0.125, 0.0, 0.25, 0.0, 0.125, 0.0, 0.25], [0.125, 0.25, 0.0, 0.125, 0.0, 0.375, 0.125, 0.0], [0.0, 0.0, 0.375, 0.0, 0.25, 0.125, 0.125, 0.125], [0.0, 0.25, 0.125, 0.25, 0.125, 0.0, 0.25, 0.0], [0.0, 0.375, 0.0, 0.125, 0.25, 0.125, 0.0, 0.125], [0.125, 0.125, 0.0, 0.0, 0.375, 0.25, 0.0, 0.125], [0.0, 0.375, 0.125, 0.0, 0.125, 0.125, 0.25, 0.0], [0.0, 0.375, 0.0, 0.0, 0.25, 0.25, 0.0, 0.125], [0.125, 0.0, 0.25, 0.25, 0.125, 0.0, 0.0, 0.25], [0.125, 0.0, 0.125, 0.25, 0.0, 0.375, 0.0, 0.125], [0.125, 0.125, 0.125, 0.375, 0.0, 0.0, 0.0, 0.25], [0.0, 0.25, 0.125, 0.25, 0.125, 0.125, 0.0, 0.125], [0.25, 0.0, 0.125, 0.0, 0.125, 0.25, 0.25, 0.0], [0.0, 0.25, 0.0, 0.25, 0.125, 0.0, 0.375, 0.0], [0.125, 0.0, 0.25, 0.0, 0.375, 0.0, 0.0, 0.25], [0.125, 0.125, 0.0, 0.25, 0.0, 0.0, 0.375, 0.125], [0.0, 0.25, 0.125, 0.0, 0.375, 0.0, 0.0, 0.25], [0.0, 0.375, 0.0, 0.125, 0.25, 0.0, 0.0, 0.25], [0.25, 0.0, 0.0, 0.25, 0.0, 0.125, 0.25, 0.125], [0.25, 0.0, 0.0, 0.25, 0.25, 0.0, 0.25, 0.0], [0.0, 0.375, 0.0, 0.25, 0.0, 0.0, 0.25, 0.125], [0.125, 0.125, 0.125, 0.0, 0.25, 0.375, 0.0, 0.0], [0.125, 0.125, 0.0, 0.25, 0.25, 0.125, 0.125, 0.0], [0.125, 0.375, 0.0, 0.0, 0.125, 0.125, 0.25, 0.0], [0.125, 0.0, 0.25, 0.0, 0.0, 0.375, 0.125, 0.125], [0.125, 0.25, 0.125, 0.0, 0.0, 0.25, 0.25, 0.0], [0.0, 0.25, 0.125, 0.125, 0.0, 0.0, 0.375, 0.125], [0.25, 0.0, 0.125, 0.125, 0.125, 0.0, 0.0, 0.375], [0.0, 0.0, 0.375, 0.125, 0.125, 0.25, 0.0, 0.125], [0.375, 0.0, 0.0, 0.125, 0.25, 0.0, 0.125, 0.125], [0.125, 0.25, 0.0, 0.125, 0.125, 0.0, 0.0, 0.375], [0.25, 0.0, 0.0, 0.375, 0.0, 0.125, 0.0, 0.25], [0.0, 0.25, 0.25, 0.0, 0.125, 0.25, 0.125, 0.0], [0.125, 0.125, 0.25, 0.125, 0.125, 0.0, 0.0, 0.25], [0.25, 0.0, 0.25, 0.0, 0.125, 0.0, 0.125, 0.25], [0.0, 0.25, 0.125, 0.125, 0.125, 0.0, 0.0, 0.375], [0.25, 0.0, 0.0, 0.125, 0.25, 0.25, 0.0, 0.125], [0.0, 0.25, 0.25, 0.0, 0.125, 0.0, 0.125, 0.25], [0.125, 0.0, 0.25, 0.0, 0.125, 0.125, 0.25, 0.125], [0.0, 0.125, 0.375, 0.0, 0.125, 0.125, 0.25, 0.0], [0.125, 0.125, 0.0, 0.375, 0.125, 0.0, 0.0, 0.25], [0.0, 0.25, 0.125, 0.125, 0.125, 0.375, 0.0, 0.0], [0.0, 0.25, 0.125, 0.125, 0.375, 0.0, 0.0, 0.125], [0.25, 0.125, 0.0, 0.125, 0.0, 0.375, 0.0, 0.125], [0.125, 0.0, 0.25, 0.25, 0.0, 0.25, 0.125, 0.0], [0.125, 0.25, 0.0, 0.25, 0.125, 0.0, 0.25, 0.0], [0.25, 0.125, 0.0, 0.25, 0.0, 0.0, 0.25, 0.125], [0.0, 0.375, 0.125, 0.0, 0.125, 0.25, 0.0, 0.125], [0.125, 0.25, 0.0, 0.125, 0.125, 0.375, 0.0, 0.0], [0.125, 0.25, 0.125, 0.125, 0.0, 0.125, 0.0, 0.25], [0.125, 0.0, 0.25, 0.375, 0.0, 0.0, 0.125, 0.125], [0.125, 0.25, 0.0, 0.375, 0.0, 0.0, 0.125, 0.125], [0.0, 0.125, 0.125, 0.25, 0.125, 0.125, 0.25, 0.0], [0.25, 0.0, 0.125, 0.0, 0.125, 0.25, 0.0, 0.25], [0.25, 0.125, 0.0, 0.0, 0.25, 0.0, 0.25, 0.125], [0.0, 0.125, 0.25, 0.0, 0.25, 0.125, 0.0, 0.25], [0.0, 0.25, 0.0, 0.25, 0.0, 0.375, 0.0, 0.125], [0.125, 0.125, 0.0, 0.375, 0.125, 0.125, 0.0, 0.125], [0.125, 0.0, 0.0, 0.375, 0.0, 0.25, 0.125, 0.125], [0.0, 0.125, 0.25, 0.0, 0.375, 0.0, 0.125, 0.125], [0.125, 0.125, 0.0, 0.25, 0.375, 0.0, 0.0, 0.125], [0.0, 0.25, 0.125, 0.0, 0.125, 0.375, 0.0, 0.125], [0.0, 0.25, 0.0, 0.25, 0.125, 0.25, 0.125, 0.0], [0.0, 0.25, 0.0, 0.25, 0.25, 0.125, 0.0, 0.125], [0.125, 0.125, 0.25, 0.0, 0.0, 0.375, 0.125, 0.0], [0.0, 0.25, 0.0, 0.375, 0.125, 0.0, 0.125, 0.125], [0.125, 0.125, 0.0, 0.375, 0.0, 0.0, 0.125, 0.25], [0.125, 0.125, 0.25, 0.0, 0.0, 0.125, 0.125, 0.25], [0.25, 0.0, 0.25, 0.0, 0.0, 0.25, 0.25, 0.0], [0.0, 0.0, 0.25, 0.25, 0.125, 0.125, 0.125, 0.125], [0.125, 0.125, 0.125, 0.25, 0.0, 0.375, 0.0, 0.0], [0.25, 0.125, 0.0, 0.125, 0.125, 0.0, 0.375, 0.0], [0.25, 0.0, 0.125, 0.25, 0.0, 0.25, 0.125, 0.0], [0.125, 0.125, 0.0, 0.125, 0.125, 0.25, 0.0, 0.25], [0.25, 0.0, 0.125, 0.0, 0.25, 0.25, 0.125, 0.0], [0.125, 0.25, 0.0, 0.0, 0.125, 0.125, 0.25, 0.125], [0.0, 0.25, 0.25, 0.0, 0.25, 0.125, 0.0, 0.125], [0.125, 0.0, 0.25, 0.0, 0.125, 0.25, 0.25, 0.0], [0.25, 0.125, 0.125, 0.0, 0.0, 0.25, 0.125, 0.125], [0.0, 0.0, 0.375, 0.25, 0.0, 0.125, 0.125, 0.125], [0.125, 0.125, 0.125, 0.0, 0.125, 0.0, 0.375, 0.125], [0.0, 0.375, 0.0, 0.25, 0.0, 0.125, 0.25, 0.0], [0.25, 0.0, 0.125, 0.125, 0.0, 0.125, 0.375, 0.0], [0.25, 0.0, 0.125, 0.25, 0.0, 0.0, 0.125, 0.25], [0.125, 0.125, 0.375, 0.0, 0.0, 0.125, 0.25, 0.0], [0.0, 0.125, 0.125, 0.25, 0.125, 0.0, 0.25, 0.125], [0.125, 0.0, 0.25, 0.25, 0.125, 0.125, 0.0, 0.125], [0.125, 0.125, 0.0, 0.25, 0.125, 0.0, 0.0, 0.375], [0.25, 0.0, 0.125, 0.375, 0.0, 0.0, 0.125, 0.125], [0.125, 0.25, 0.0, 0.0, 0.375, 0.0, 0.25, 0.0], [0.25, 0.0, 0.125, 0.25, 0.125, 0.0, 0.25, 0.0], [0.0, 0.125, 0.125, 0.25, 0.0, 0.25, 0.125, 0.125], [0.125, 0.0, 0.25, 0.0, 0.125, 0.375, 0.0, 0.125], [0.25, 0.0, 0.125, 0.25, 0.0, 0.0, 0.375, 0.0], [0.25, 0.0, 0.25, 0.0, 0.125, 0.0, 0.375, 0.0], [0.25, 0.0, 0.0, 0.125, 0.25, 0.0, 0.25, 0.125], [0.125, 0.25, 0.0, 0.25, 0.0, 0.0, 0.125, 0.25], [0.125, 0.0, 0.25, 0.0, 0.375, 0.125, 0.0, 0.125], [0.0, 0.125, 0.0, 0.375, 0.125, 0.125, 0.125, 0.125], [0.0, 0.25, 0.25, 0.125, 0.125, 0.0, 0.125, 0.125], [0.0, 0.25, 0.25, 0.0, 0.0, 0.375, 0.0, 0.125], [0.25, 0.0, 0.0, 0.25, 0.0, 0.25, 0.25, 0.0], [0.0, 0.25, 0.0, 0.25, 0.25, 0.0, 0.25, 0.0], [0.0, 0.375, 0.0, 0.25, 0.0, 0.125, 0.0, 0.25], [0.0, 0.125, 0.125, 0.25, 0.125, 0.25, 0.0, 0.125], [0.125, 0.125, 0.375, 0.0, 0.0, 0.25, 0.0, 0.125], [0.125, 0.125, 0.125, 0.125, 0.375, 0.0, 0.125, 0.0], [0.125, 0.0, 0.25, 0.125, 0.0, 0.0, 0.375, 0.125], [0.125, 0.125, 0.0, 0.25, 0.125, 0.375, 0.0, 0.0], [0.0, 0.375, 0.0, 0.0, 0.125, 0.25, 0.125, 0.125], [0.125, 0.125, 0.25, 0.0, 0.125, 0.375, 0.0, 0.0], [0.125, 0.0, 0.125, 0.25, 0.0, 0.25, 0.0, 0.25], [0.125, 0.0, 0.0, 0.375, 0.25, 0.0, 0.125, 0.125], [0.125, 0.0, 0.125, 0.25, 0.125, 0.0, 0.375, 0.0], [0.25, 0.125, 0.0, 0.125, 0.25, 0.0, 0.25, 0.0], [0.0, 0.375, 0.125, 0.0, 0.125, 0.125, 0.0, 0.25], [0.25, 0.0, 0.0, 0.25, 0.0, 0.375, 0.0, 0.125], [0.125, 0.0, 0.375, 0.125, 0.0, 0.125, 0.25, 0.0], [0.125, 0.125, 0.125, 0.0, 0.0, 0.5, 0.0, 0.125], [0.125, 0.25, 0.0, 0.125, 0.0, 0.125, 0.125, 0.25], [0.25, 0.125, 0.0, 0.125, 0.0, 0.25, 0.0, 0.25], [0.125, 0.25, 0.0, 0.25, 0.0, 0.25, 0.125, 0.0], [0.0, 0.25, 0.0, 0.375, 0.0, 0.125, 0.0, 0.25], [0.0, 0.25, 0.0, 0.25, 0.25, 0.0, 0.0, 0.25], [0.125, 0.0, 0.25, 0.25, 0.0, 0.0, 0.375, 0.0], [0.0, 0.125, 0.375, 0.0, 0.0, 0.25, 0.125, 0.125], [0.25, 0.0, 0.125, 0.0, 0.375, 0.125, 0.0, 0.125], [0.125, 0.125, 0.25, 0.0, 0.0, 0.125, 0.375, 0.0], [0.125, 0.125, 0.0, 0.125, 0.125, 0.375, 0.0, 0.125], [0.0, 0.25, 0.0, 0.125, 0.25, 0.125, 0.25, 0.0], [0.25, 0.0, 0.0, 0.375, 0.0, 0.0, 0.25, 0.125], [0.25, 0.0, 0.25, 0.0, 0.25, 0.0, 0.25, 0.0], [0.125, 0.125, 0.0, 0.0, 0.375, 0.0, 0.25, 0.125], [0.125, 0.125, 0.25, 0.0, 0.125, 0.0, 0.0, 0.375], [0.125, 0.0, 0.0, 0.5, 0.0, 0.125, 0.125, 0.125], [0.25, 0.0, 0.125, 0.0, 0.125, 0.375, 0.0, 0.125], [0.0, 0.25, 0.125, 0.0, 0.25, 0.0, 0.125, 0.25], [0.125, 0.125, 0.125, 0.0, 0.0, 0.25, 0.25, 0.125], [0.375, 0.0, 0.0, 0.25, 0.0, 0.125, 0.125, 0.125], [0.25, 0.0, 0.0, 0.25, 0.125, 0.0, 0.125, 0.25], [0.0, 0.125, 0.25, 0.125, 0.0, 0.25, 0.25, 0.0], [0.25, 0.0, 0.0, 0.125, 0.375, 0.0, 0.125, 0.125], [0.125, 0.0, 0.375, 0.125, 0.0, 0.125, 0.0, 0.25], [0.0, 0.25, 0.125, 0.25, 0.0, 0.25, 0.125, 0.0], [0.125, 0.0, 0.0, 0.375, 0.125, 0.125, 0.25, 0.0], [0.25, 0.125, 0.125, 0.0, 0.125, 0.125, 0.25, 0.0], [0.0, 0.0, 0.375, 0.125, 0.125, 0.125, 0.25, 0.0], [0.0, 0.125, 0.25, 0.125, 0.25, 0.0, 0.25, 0.0], [0.25, 0.125, 0.0, 0.0, 0.25, 0.125, 0.25, 0.0], [0.125, 0.375, 0.0, 0.0, 0.125, 0.25, 0.0, 0.125], [0.0, 0.25, 0.125, 0.0, 0.375, 0.125, 0.0, 0.125], [0.25, 0.0, 0.25, 0.0, 0.25, 0.125, 0.0, 0.125], [0.0, 0.25, 0.25, 0.0, 0.0, 0.125, 0.25, 0.125], [0.25, 0.0, 0.0, 0.25, 0.0, 0.25, 0.0, 0.25], [0.125, 0.0, 0.25, 0.0, 0.375, 0.0, 0.25, 0.0], [0.25, 0.125, 0.0, 0.0, 0.25, 0.25, 0.0, 0.125], [0.25, 0.0, 0.125, 0.125, 0.0, 0.375, 0.125, 0.0], [0.125, 0.0, 0.375, 0.0, 0.25, 0.0, 0.25, 0.0], [0.25, 0.0, 0.125, 0.25, 0.125, 0.125, 0.0, 0.125], [0.25, 0.0, 0.25, 0.0, 0.25, 0.0, 0.0, 0.25], [0.125, 0.25, 0.125, 0.0, 0.0, 0.375, 0.0, 0.125], [0.125, 0.0, 0.125, 0.375, 0.0, 0.0, 0.25, 0.125], [0.0, 0.375, 0.0, 0.125, 0.125, 0.25, 0.125, 0.0], [0.25, 0.0, 0.125, 0.0, 0.25, 0.0, 0.375, 0.0], [0.125, 0.0, 0.25, 0.125, 0.0, 0.375, 0.125, 0.0], [0.0, 0.125, 0.25, 0.25, 0.0, 0.125, 0.25, 0.0], [0.0, 0.25, 0.125, 0.0, 0.125, 0.25, 0.0, 0.25], [0.125, 0.0, 0.375, 0.0, 0.125, 0.0, 0.125, 0.25], [0.125, 0.125, 0.25, 0.0, 0.375, 0.0, 0.0, 0.125], [0.25, 0.25, 0.0, 0.0, 0.125, 0.125, 0.125, 0.125], [0.0, 0.25, 0.0, 0.375, 0.0, 0.0, 0.25, 0.125], [0.0, 0.0, 0.375, 0.125, 0.125, 0.125, 0.0, 0.25], [0.125, 0.125, 0.0, 0.375, 0.125, 0.0, 0.25, 0.0], [0.125, 0.125, 0.125, 0.0, 0.375, 0.125, 0.125, 0.0], [0.125, 0.125, 0.125, 0.125, 0.0, 0.0, 0.5, 0.0], [0.0, 0.125, 0.375, 0.0, 0.125, 0.0, 0.25, 0.125], [0.375, 0.0, 0.0, 0.125, 0.125, 0.25, 0.0, 0.125], [0.125, 0.0, 0.375, 0.0, 0.125, 0.25, 0.125, 0.0], [0.25, 0.0, 0.25, 0.125, 0.125, 0.0, 0.125, 0.125], [0.125, 0.0, 0.25, 0.0, 0.25, 0.25, 0.125, 0.0], [0.125, 0.125, 0.0, 0.375, 0.0, 0.25, 0.125, 0.0], [0.0, 0.25, 0.25, 0.125, 0.0, 0.125, 0.0, 0.25], [0.25, 0.0, 0.25, 0.125, 0.0, 0.0, 0.25, 0.125], [0.125, 0.25, 0.0, 0.125, 0.25, 0.125, 0.125, 0.0], [0.125, 0.125, 0.0, 0.25, 0.0, 0.375, 0.125, 0.0], [0.0, 0.25, 0.0, 0.25, 0.0, 0.25, 0.25, 0.0], [0.0, 0.125, 0.25, 0.0, 0.25, 0.25, 0.0, 0.125], [0.25, 0.125, 0.0, 0.25, 0.0, 0.25, 0.0, 0.125], [0.125, 0.25, 0.0, 0.0, 0.125, 0.25, 0.25, 0.0], [0.0, 0.25, 0.0, 0.125, 0.25, 0.0, 0.25, 0.125], [0.25, 0.0, 0.375, 0.0, 0.0, 0.125, 0.125, 0.125], [0.125, 0.125, 0.125, 0.375, 0.0, 0.0, 0.25, 0.0], [0.25, 0.0, 0.0, 0.0, 0.375, 0.125, 0.125, 0.125], [0.0, 0.25, 0.25, 0.125, 0.0, 0.25, 0.0, 0.125], [0.0, 0.25, 0.0, 0.375, 0.0, 0.25, 0.0, 0.125], [0.125, 0.125, 0.0, 0.0, 0.375, 0.125, 0.25, 0.0], [0.0, 0.375, 0.0, 0.125, 0.0, 0.25, 0.0, 0.25], [0.0, 0.25, 0.0, 0.25, 0.125, 0.0, 0.125, 0.25], [0.125, 0.0, 0.125, 0.125, 0.375, 0.0, 0.125, 0.125], [0.125, 0.0, 0.375, 0.0, 0.0, 0.125, 0.25, 0.125], [0.125, 0.0, 0.375, 0.0, 0.25, 0.0, 0.0, 0.25], [0.0, 0.25, 0.125, 0.125, 0.0, 0.125, 0.375, 0.0], [0.125, 0.0, 0.125, 0.125, 0.25, 0.0, 0.25, 0.125], [0.125, 0.0, 0.25, 0.125, 0.0, 0.125, 0.375, 0.0], [0.25, 0.0, 0.125, 0.125, 0.0, 0.125, 0.125, 0.25], [0.25, 0.125, 0.125, 0.0, 0.125, 0.125, 0.0, 0.25], [0.125, 0.0, 0.25, 0.125, 0.25, 0.125, 0.125, 0.0], [0.125, 0.125, 0.125, 0.125, 0.0, 0.125, 0.0, 0.375], [0.125, 0.0, 0.25, 0.125, 0.0, 0.125, 0.125, 0.25], [0.0, 0.25, 0.125, 0.25, 0.0, 0.0, 0.125, 0.25], [0.0, 0.375, 0.0, 0.0, 0.25, 0.125, 0.25, 0.0], [0.25, 0.0, 0.0, 0.25, 0.125, 0.0, 0.375, 0.0], [0.0, 0.375, 0.0, 0.125, 0.125, 0.0, 0.125, 0.25], [0.0, 0.125, 0.25, 0.25, 0.0, 0.125, 0.0, 0.25], [0.0, 0.125, 0.25, 0.125, 0.25, 0.0, 0.0, 0.25], [0.125, 0.375, 0.0, 0.0, 0.25, 0.0, 0.125, 0.125], [0.125, 0.25, 0.125, 0.125, 0.0, 0.0, 0.25, 0.125], [0.125, 0.0, 0.125, 0.125, 0.25, 0.25, 0.0, 0.125], [0.125, 0.125, 0.125, 0.0, 0.5, 0.0, 0.0, 0.125], [0.0, 0.25, 0.0, 0.125, 0.25, 0.25, 0.0, 0.125], [0.0, 0.375, 0.0, 0.125, 0.0, 0.375, 0.0, 0.125], [0.0, 0.375, 0.0, 0.25, 0.125, 0.0, 0.125, 0.125], [0.125, 0.125, 0.125, 0.375, 0.0, 0.125, 0.0, 0.125], [0.25, 0.125, 0.0, 0.0, 0.25, 0.125, 0.0, 0.25], [0.0, 0.125, 0.25, 0.125, 0.0, 0.25, 0.0, 0.25], [0.25, 0.0, 0.25, 0.0, 0.0, 0.125, 0.25, 0.125], [0.25, 0.125, 0.125, 0.0, 0.125, 0.25, 0.0, 0.125], [0.375, 0.0, 0.0, 0.125, 0.125, 0.125, 0.25, 0.0], [0.125, 0.0, 0.0, 0.375, 0.125, 0.25, 0.0, 0.125], [0.125, 0.0, 0.125, 0.375, 0.0, 0.125, 0.25, 0.0], [0.0, 0.25, 0.125, 0.0, 0.125, 0.25, 0.25, 0.0], [0.125, 0.0, 0.375, 0.125, 0.0, 0.0, 0.25, 0.125], [0.125, 0.0, 0.25, 0.25, 0.0, 0.0, 0.125, 0.25], [0.0, 0.25, 0.0, 0.0, 0.375, 0.125, 0.125, 0.125], [0.0, 0.125, 0.25, 0.0, 0.25, 0.125, 0.25, 0.0], [0.125, 0.125, 0.375, 0.0, 0.125, 0.0, 0.125, 0.125], [0.125, 0.125, 0.125, 0.0, 0.25, 0.0, 0.0, 0.375], [0.25, 0.0, 0.125, 0.0, 0.375, 0.0, 0.0, 0.25], [0.125, 0.25, 0.125, 0.125, 0.0, 0.125, 0.25, 0.0], [0.25, 0.0, 0.125, 0.125, 0.25, 0.125, 0.125, 0.0], [0.125, 0.0, 0.25, 0.25, 0.125, 0.0, 0.25, 0.0], [0.0, 0.0, 0.375, 0.125, 0.25, 0.0, 0.125, 0.125], [0.25, 0.125, 0.125, 0.0, 0.125, 0.0, 0.25, 0.125], [0.0, 0.25, 0.0, 0.375, 0.0, 0.125, 0.25, 0.0], [0.125, 0.125, 0.0, 0.0, 0.375, 0.125, 0.0, 0.25], [0.375, 0.0, 0.0, 0.0, 0.25, 0.125, 0.125, 0.125], [0.25, 0.0, 0.0, 0.375, 0.0, 0.125, 0.25, 0.0], [0.125, 0.0, 0.125, 0.125, 0.25, 0.125, 0.0, 0.25], [0.25, 0.0, 0.125, 0.0, 0.375, 0.0, 0.25, 0.0], [0.125, 0.25, 0.125, 0.125, 0.0, 0.25, 0.0, 0.125], [0.25, 0.0, 0.0, 0.25, 0.25, 0.125, 0.0, 0.125], [0.25, 0.125, 0.0, 0.125, 0.25, 0.0, 0.0, 0.25], [0.0, 0.25, 0.125, 0.125, 0.0, 0.375, 0.125, 0.0], [0.0, 0.0, 0.375, 0.125, 0.0, 0.25, 0.125, 0.125], [0.125, 0.25, 0.0, 0.125, 0.0, 0.0, 0.375, 0.125], [0.125, 0.0, 0.375, 0.125, 0.0, 0.25, 0.0, 0.125], [0.0, 0.0, 0.5, 0.0, 0.125, 0.125, 0.125, 0.125], [0.25, 0.0, 0.125, 0.25, 0.125, 0.0, 0.0, 0.25], [0.0, 0.25, 0.25, 0.0, 0.125, 0.0, 0.375, 0.0], [0.25, 0.0, 0.0, 0.125, 0.25, 0.125, 0.0, 0.25], [0.0, 0.125, 0.25, 0.25, 0.0, 0.25, 0.0, 0.125], [0.125, 0.125, 0.25, 0.0, 0.25, 0.125, 0.125, 0.0], [0.0, 0.375, 0.125, 0.125, 0.0, 0.125, 0.125, 0.125], [0.125, 0.25, 0.0, 0.125, 0.0, 0.125, 0.375, 0.0], [0.25, 0.125, 0.0, 0.0, 0.375, 0.0, 0.125, 0.125], [0.125, 0.125, 0.0, 0.25, 0.0, 0.125, 0.125, 0.25], [0.0, 0.25, 0.25, 0.125, 0.0, 0.125, 0.25, 0.0], [0.25, 0.0, 0.125, 0.0, 0.125, 0.125, 0.25, 0.125], [0.125, 0.375, 0.0, 0.125, 0.0, 0.125, 0.125, 0.125], [0.0, 0.125, 0.125, 0.375, 0.0, 0.125, 0.125, 0.125], [0.125, 0.0, 0.125, 0.25, 0.25, 0.0, 0.0, 0.25], [0.0, 0.375, 0.0, 0.125, 0.25, 0.0, 0.25, 0.0], [0.125, 0.25, 0.0, 0.0, 0.375, 0.0, 0.0, 0.25], [0.0, 0.375, 0.0, 0.25, 0.0, 0.25, 0.0, 0.125], [0.0, 0.125, 0.25, 0.125, 0.125, 0.0, 0.375, 0.0], [0.125, 0.125, 0.125, 0.125, 0.0, 0.0, 0.25, 0.25], [0.0, 0.25, 0.125, 0.25, 0.0, 0.0, 0.375, 0.0], [0.125, 0.125, 0.0, 0.125, 0.25, 0.0, 0.375, 0.0], [0.0, 0.125, 0.375, 0.0, 0.25, 0.0, 0.125, 0.125], [0.0, 0.125, 0.125, 0.25, 0.125, 0.125, 0.0, 0.25]]
print(f"Number of vertices: {len(sim_V)}")

def count_zeros(histogram):
    count = 0
    for i in histogram:
        if i == 0:
            count += 1
    return count

zero_counts = defaultdict(int)

for v in sim_V:
    zero_counts[count_zeros(v)] += 1

print(zero_counts)
